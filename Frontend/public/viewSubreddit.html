<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <link rel="stylesheet" href="./css/viewsubreddit.css">
    <title>Reddit clone </title>
</head>

<script>
    $(document).ready(function () {
        var urlParams = new URLSearchParams(window.location.search)
        var subredditid = urlParams.get('subreddit_id')
        var postshtml = "";
        $.ajax({
            url: `http://localhost:8000/api/post/subredditPost/${subredditid}`,
            type: "GET",
            contentType: "application/json",
            dataType: "json",
            success: function (data, textStatus, xhr) {
            if (data != null) {
              data.post.map((d) => {
                postshtml +=
                  `
                  `
                    if(d.cloudinary_url != null){
                      postshtml +=  `
                      <div class = "card">
                    <div>
                       Title: ${d.title}
                    </div>
                    <div>
                        <img src= "${d.cloudinary_url}"/>
                    <div>
                        <div>
                       Content: ${d.body}
                    </div>
                    <div>
                       Created at: ${d.created_at}
                    </div>
                    
                    
                  </div>
                      `
                    }else{
                      postshtml += `
                      <div class = "card">
                      <div>
                       Title: ${d.title}
                    </div>
                    <div>
                       Content: ${d.body}
                    </div>
                    
                    <div>
                       Created At: ${d.created_at}
                    </div>
                  </div>`
                    }
                
              });
              $("#posts").append(postshtml);
            } else {
              console.log("Issue in retrieving...");
            }
          },
            error: function (xhr, textStatus, err) {
                console.log(err);
            },
        });
    });
</script>

<body>
    <div>
        <table id="posts">
            


        </table>
    </div>
</body>

</html>